# Getting Started

- This project is a simple example of how to integrate Clerk with Spring Boot and Next.js
- The Spring Boot application acts as a resource server
- The Next.js application acts as a client
- The Clerk is used for authentication
- The Clerk Webhooks is used to sync data to the application

## Structure

- `spring-boot` - Spring Boot application that acts as a resource server
- `nextjs` - Next.js application that acts as a client `src/main/frontend`

## Prerequisites

- Create Clerk Account and add a new application to get the API Keys (You can go to Developers -> API Keys section to
  retrieve the keys)
- You should use Ngrok to expose your local server to the internet to test the webhook URL (or use static domain)
- Setup Webhook URL in Clerk (You can go to Configure -> Webhooks section to add a new webhook URL)  to
  `https://<domain-from-ngrok>/api/clerk/webhook`

### Environment Variables

1. Spring boot (rename the `.env.example` to `.env` and add the values)

- `WEBHOOK_SECRET` - The secret key that you have set in the webhook URL in Clerk
- `JWKS_URL` - The JWKS URL that you can get from the API Keys section in Clerk

2. Next.js (rename the `.env.example` to `.env` and add the values)

- `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` - The publishable key that you have set in the API Keys section in Clerk
- `CLERK_SECRET_KEY` - The secret key that you have set in the API Keys section in Clerk
- `NEXT_PUBLIC_CLERK_SIGN_IN_URL` default value is `/sign-in`
- `NEXT_PUBLIC_CLERK_SIGN_UP_URL` default value is `/sign-up`
- `API_URL` - The URL of the Spring Boot application (you should use the URL generated by ngrok)

## Running the application

- Start the Spring Boot application: `./mvnw spring-boot:run` (should be setup environment variables first)
- Run ngrok to expose the Spring Boot application to the internet: `ngrok http 8080` (or use static domain)
- Start the Next.js application: `npm run dev`

### Reference Documentation

- [Clerk - Next.js Quickstart](https://docs.clerk.dev/nextjs/getting-started)
- [Sync Clerk data to your application with webhooks](https://clerk.com/docs/integrations/webhooks/sync-data)
- [OAuth 2.0 Resource Server JWT](https://docs.spring.io/spring-security/reference/servlet/oauth2/resource-server/jwt.html#oauth2resourceserver-jwt-decoder-public-key-builder)

### Contributing

- `chore: <description>` for commit that doesn't affect much to the project
- `feat: <description>` for commit that add new feature
- `fix: <description>` for commit that fix bug
- `docs: <description>` for commit that add documentation or comment
- `perf: <description>` for commit that improve performance
- `refactor: <description>` for commit that refactor or format code
- `style: <description>` for commit that change style or related to style that doesn't affect to logic code (only for
  front-end)